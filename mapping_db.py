import re

# ==============================================================================
# [1] 선거 단위 - 담당 선관위 매핑 데이터베이스
# ==============================================================================
ELECTION_DB = {
    "총학생회": "중앙선거관리위원회",
    "총동아리연합회": "총동아리연합회",
    "창작예술분과위원회": "총동아리연합회",
    "체육분과위원회": "총동아리연합회",
    "공연예술분과위원회": "총동아리연합회",
    "학술교양분과위원회": "총동아리연합회",
    "중어중문학과": "문과대학", "영어영문학과": "문과대학", "독어독문학과": "문과대학",
    "노어노문학과": "문과대학", "사학과": "문과대학", "철학과": "문과대학",
    "문헌정보학과": "문과대학", "심리학과": "문과대학",
    "상경·경영대학": "상경·경영대학",
    "경영 1반": "상경·경영대학", "경영 2반": "상경·경영대학", "경영 3반": "상경·경영대학",
    "경영 4반": "상경·경영대학", "경영 5반": "상경·경영대학",
    "상경 6반": "상경·경영대학", "상경 7반": "상경·경영대학", "상경 8반": "상경·경영대학",
    "상경 9반": "상경·경영대학", "상경 10반": "상경·경영대학", "상경 11반": "상경·경영대학",
    "수학과": "이과대학", "물리학과": "이과대학", "화학과": "이과대학",
    "지구시스템과학과": "이과대학", "천문우주학과": "이과대학", "대기과학과": "이과대학",
    "인공지능융합대학": "인공지능융합대학",
    "컴퓨터과학과": "인공지능융합대학",
    "첨단융합공학부": "인공지능융합대학",
    "인공지능학과": "인공지능융합대학",
    "공학 1반": "공과대학", "공학 2반": "공과대학", "공학 4반": "공과대학",
    "공학 6반": "공과대학", "공학 7반": "공과대학", "공학 8반": "공과대학",
    "공학 9반": "공과대학", "공학 10반": "공과대학", "공학 11반": "공과대학",
    "연세건축 아시비": "공과대학", "도시공학과": "공과대학",
    "시스템반도체공학과": "공과대학", "디스플레이융합공학과": "공과대학",
    "신과대학": "신과대학",
    "문화인류학과": "사회과학대학", "사회복지학과": "사회과학대학", "사회학과": "사회과학대학",
    "언론홍보영상학부": "사회과학대학", "정치외교학과": "사회과학대학", "행정학과": "사회과학대학",
    "사회과학대학 동아리연합회": "사회과학대학",
    "시스템생물학과": "생명시스템대학", "생화학과": "생명시스템대학", "생명공학과": "생명시스템대학",
    "음악대학": "음악대학", "관현악과": "음악대학",
    "피아노과": "음악대학", "작곡과": "음악대학",
    "의류환경학과": "생활과학대학", "식품영양학과": "생활과학대학", "실내건축학과": "생활과학대학",
    "아동·가족학과": "생활과학대학", "아동가족학과": "생활과학대학",
    "아동•가족학과": "생활과학대학",
    "통합디자인학과": "생활과학대학",
    "체육계열": "체육계열",
    "의과대학": "의과대학", "의예과": "의과대학",
    "의과대학 동아리연합회장": "의과대학",
    "치과대학": "치과대학",
    "간호대학": "간호대학",
    "언더우드국제대학": "언더우드국제대학",
    "비교문학과문화전공": "언더우드국제대학", "경제학전공": "언더우드국제대학",
    "국제학전공": "언더우드국제대학", "정치외교학전공": "언더우드국제대학",
    "아시아학전공": "언더우드국제대학", "문화디자인경영전공": "언더우드국제대학",
    "창의기술경영전공": "언더우드국제대학", "정보인터랙션디자인전공": "언더우드국제대학",
    "사회정의리더십전공": "언더우드국제대학", "계량위험관리전공": "언더우드국제대학",
    "에너지환경융합전공": "언더우드국제대학", "나노과학공학전공": "언더우드국제대학",
    "약학대학": "약학대학",
    "글로벌인재대학": "글로벌인재대학",
    "국제통상전공": "글로벌인재대학", "문화미디어전공": "글로벌인재대학",
    "응용정보공학전공": "글로벌인재대학", "외국인 학생회": "글로벌인재대학"
}

# ==============================================================================
# [2] 합산 대상 단위 목록 (TARGET_UNITS)
# ==============================================================================
TARGET_UNITS = [
    "중어중문학과", "영어영문학과", "독어독문학과", "노어노문학과", "사학과", "철학과", "문헌정보학과", "심리학과",
    "상경·경영대학",  # 학생회 선거
    "수학과", "물리학과", "화학과", "지구시스템과학과", "천문우주학과", "대기과학과",
    # "인공지능융합대학", (제외)
    "공학 1반", "공학 2반", "공학 4반", "컴퓨터과학과",
    "공학 6반", "공학 7반", "공학 8반", "공학 9반", "공학 10반", "공학 11반",
    "연세건축 아시비", "도시공학과", "첨단융합공학부", "시스템반도체공학과", "인공지능학과", "디스플레이융합공학과",
    "신과대학",
    "문화인류학과", "사회복지학과", "사회학과 학생총투표", "언론홍보영상학부", "정치외교학과", "행정학과",
    "시스템생물학과", "생화학과", "생명공학과",
    "관현악과(현)", "관현악과(관)", "피아노과", "작곡과",
    "의류환경학과", "식품영양학과", "실내건축학과", "아동가족학과", "통합디자인학과",
    "체육계열",
    "의과대학", "치과대학", "간호대학", "약학대학",
    "언더우드국제대학",
    "외국인 학생회"
]


# ==============================================================================
# [함수] 매핑 및 판별 로직
# ==============================================================================

def get_commission(name):
    """이름으로 선관위 찾기 (긴 단어 우선 매칭)"""
    sorted_keys = sorted(ELECTION_DB.keys(), key=len, reverse=True)
    for key in sorted_keys:
        if key in name:
            return ELECTION_DB[key]
    return "기타/공통"


def is_target_unit(name):
    """합산 대상(Value 계산용)인지 확인"""
    for t in TARGET_UNITS:
        if t in name:
            # [예외 1] 타겟명에는 '총투표'가 없는데, 실제 이름에 '총투표'가 있으면 제외
            if "총투표" in name and "총투표" not in t:
                continue

            # [예외 2] 의과대학 하위 단위(동아리, 의예과) 제외
            if t == "의과대학" and ("동아리" in name or "의예과" in name):
                continue

            return True
    return False